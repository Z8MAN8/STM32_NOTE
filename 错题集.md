# 错题集

 *记录在rm战队中，以及嵌入式学习之路上所遇到的问题和进去过的坑，希望这些能让我变得更强大。*

- 通信协议（openmv）
- 串口多机通信 RS485
-  软件uart
-  freertos内存大小问题：在搭建代码框架的时候，之前创建的freertos任务都是可以正常运行的，但是新建的任务就出现了问题，调试的时候发现一直不进新建的任务，修改了任务优先级，延时时长都不行。之后查看了任务调度状态发现了异常，转到新建任务的创建部分进行调试，发现任务句柄为空，创建任务失败。调整了任务创建的先后顺序，发现先创建的任务正常，后创建的任务异常。怀疑是内存分配不足，导致可以正常创建的任务数量少，随后转到FreeRTOSConfig.h文件更改configTOTAL_HEAP_SIZE的大小，重新调试，所有任务正常创建和运行，成功解决问题。
-  每次使用cubeMX更新设置以后，都要记得补充CmakeList，以及修改FreeRTOSConfig.h文件，以及其他会被重置的设置，否则许多之前修好的bug会重现。
-  电赛在调小车的时候，使用了TB6612驱动模块和STM32F103C8T6最小系统板，一开始是调单独一个电机的PID的时候，接着有线调试器调好的参数，拔了调试器脱机运行就不行了，导致这个问题的原因是接了调试器以后，需要注意主控的供电，否则可能导致电压差异，导致调试时和脱机时电机转动不同，或者直接使用无限调试器，也能避免这个问题。
-  电赛调小车电机的时候还遇到一个比较玄学的问题，就是两个电机的编码器，TIM2读取正常，但是TIM1的CNT就随机波动，交换以后TIM1仍旧异常，甚至把电机的线拔了以后TIM1还是随机波动。一开始以为是两个电机的霍尔编码器距离太近产生干扰，于是尝试在中间插入一块铁片，还尝试将电机拆下相互远离，但问题依旧存在。最终将TB6612驱动板和主控的供电相互分开以后，编码器才能终于正常。由于疫情隔离在家，工具不足，经过反复实验，认为问题所在是因为电机转动产生的电压波动，且通过驱动板与主控之间供电的连接，影响了主控，导致主控TIM1引脚电压波动异常，得出异常结果。经过此次经验，对于电机这类可能产生电压波动的外设，需要注意对主控的反向影响，最好将其与主控的供电分离开，或者使用二极管之类的单向导通。否则容易出现一些诡异，不易找到源头的异常。
